:root {
  --bg-color: #000000;
  --sidebar-color: #161617;
  --main-color: #000000;
  --accent-blue: #007aff;
  --accent-red: #ff3b30;
  --accent-green: #34c759;
  --accent-orange: #ff9500;
  --text-primary: #ffffff;
  --text-secondary: #86868b;
  --border-color: #2d2d2f;
  --surface-glass: rgba(255, 255, 255, 0.08);
  --border-radius-lg: 20px;
}

html, body, #root {
  margin: 0;
  padding: 0;
  height: 100%;
  width: 100%;
  background-color: var(--bg-color);
  color: var(--text-primary);
  font-family: -apple-system, BlinkMacSystemFont, "SF Pro Text", "SF Pro Display", system-ui, sans-serif;
  overflow: hidden; 
}

.App.sidebar-layout {
  display: flex;
  height: 100%;
  width: 100%;
  position: relative;
  overflow: hidden;
}

/* Responsive Utilities */
.desktop-only { display: flex; }
.mobile-only { display: none; }

@media (max-width: 768px) {
  .desktop-only { display: none !important; }
  .mobile-only { display: flex !important; }
}

/* Sidebar Styling */
.sidebar {
  width: 280px;
  background-color: var(--sidebar-color);
  border-right: 1px solid var(--border-color);
  display: flex;
  flex-direction: column;
  flex-shrink: 0;
  transition: transform 0.3s ease-in-out;
  z-index: 100;
}

.sidebar-header {
  padding: 24px;
  display: flex;
  align-items: center;
  gap: 12px;
  border-bottom: 1px solid var(--border-color);
}

.sidebar-header h2 {
  margin: 0;
  font-size: 1.2em;
  font-weight: 600;
  flex: 1;
}

.sidebar-close-btn {
  background: none; border: none; color: white; cursor: pointer; padding: 4px;
}

.sidebar-scroll-area {
  flex: 1;
  overflow-y: auto;
  padding: 20px 0;
}

.sidebar-section {
  margin-bottom: 8px;
  padding: 0 12px;
}

.section-title {
  padding: 12px 16px;
  display: flex;
  justify-content: space-between;
  align-items: center;
  cursor: pointer;
  user-select: none;
  background-color: var(--surface-glass);
  border-radius: 10px;
  transition: background-color 0.2s;
}

.section-title:hover {
  background-color: rgba(255, 255, 255, 0.12);
}

.title-left {
  display: flex;
  align-items: center;
  gap: 12px;
}

.title-left h3 {
  margin: 0;
  font-size: 0.9em;
  font-weight: 600;
  color: var(--text-primary);
  text-transform: none; 
}

.title-right {
  display: flex;
  align-items: center;
  gap: 12px;
}

.accordion-chevron {
  color: var(--accent-blue);
  transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

.sidebar-section.expanded .accordion-chevron {
  transform: rotate(90deg);
}

.count-badge {
  font-size: 0.9em;
  color: var(--text-secondary);
}

.sidebar-content {
  max-height: 0;
  overflow: hidden;
  transition: max-height 0.3s ease-in-out;
  padding: 0 4px;
}

.sidebar-section.expanded .sidebar-content {
  max-height: 800px;
}

.sidebar-device-list {
  display: flex;
  flex-direction: column;
  margin-top: 4px;
}

.sidebar-device-item {
  padding: 12px 16px;
  margin: 2px 0;
  display: flex;
  justify-content: flex-start;
  align-items: center;
  cursor: pointer;
  transition: background-color 0.2s;
  border-radius: 8px;
  gap: 12px;
}

.sidebar-device-item:hover { background-color: rgba(255, 255, 255, 0.05); }
.sidebar-device-item.active { background-color: rgba(0, 122, 255, 0.15); }
.sidebar-device-item.offline { opacity: 0.4; }

.device-status-dot {
  width: 8px;
  height: 8px;
  border-radius: 50%;
  flex-shrink: 0;
}

.device-status-dot.online { background-color: var(--accent-green); box-shadow: 0 0 6px var(--accent-green); }
.device-status-dot.offline { background-color: var(--accent-red); }
.device-status-dot.loading { background-color: #666; animation: pulse 1.5s infinite; }

@keyframes pulse {
  0% { opacity: 1; }
  50% { opacity: 0.4; }
  100% { opacity: 1; }
}

.item-info { display: flex; flex-direction: column; gap: 1px; flex: 1; }
.device-name { font-weight: 400; font-size: 0.95em; }

.protocol-tags {
  display: flex;
  gap: 4px;
  margin-top: 2px;
}

.proto-tag {
  font-size: 0.6em;
  padding: 1px 4px;
  background-color: rgba(255, 255, 255, 0.1);
  border-radius: 4px;
  color: var(--text-secondary);
  text-transform: uppercase;
}

.unpaired-notice {
  margin: 0 16px 8px 16px;
  padding: 8px 12px;
  background-color: rgba(255, 149, 0, 0.1);
  border-radius: 8px;
  display: flex;
  align-items: center;
  gap: 8px;
  font-size: 0.75em;
  color: var(--accent-orange);
}

.pair-link.small {
  margin-left: auto;
  font-weight: 600;
  font-size: 1em;
}

.sidebar-device-item-container.active {
  background-color: rgba(0, 122, 255, 0.15);
  border-radius: 8px;
}

.delete-mini {
  background: none; border: none; color: var(--text-secondary); opacity: 0; transition: opacity 0.2s; padding: 4px;
  display: flex; align-items: center; justify-content: center;
}
.sidebar-device-item:hover .delete-mini { opacity: 1; }
.delete-mini:hover { color: var(--accent-red); }

.refresh-btn {
  background: none; border: none; color: var(--accent-blue); cursor: pointer; padding: 0;
}

.pairing-step-msg {
  font-size: 0.8em;
  color: var(--text-secondary);
  margin: 0 0 5px 0;
  text-align: center;
  font-weight: 500;
}

.sidebar-empty-state { padding: 16px; text-align: center; }
.sidebar-empty-state p { margin: 0; font-size: 0.8em; color: var(--text-secondary); font-style: italic; }

.sidebar-footer { padding: 24px; border-top: 1px solid var(--border-color); display: flex; flex-direction: column; gap: 16px; }

.rescan-btn {
  width: 100%; padding: 12px; background-color: var(--accent-blue); border: none; border-radius: 12px; color: white; font-size: 0.9em; font-weight: 600; display: flex; align-items: center; justify-content: center; gap: 8px; cursor: pointer; transition: background-color 0.2s, transform 0.1s;
}
.rescan-btn:hover:not(:disabled) { background-color: #0062cc; }
.rescan-btn:active:not(:disabled) { transform: scale(0.98); }
.rescan-btn:disabled { opacity: 0.6; cursor: not-allowed; }
.rescan-btn.scanning { background-color: var(--surface-accent); color: var(--text-secondary); }

.backend-status { 
  display: flex; 
  align-items: center; 
  justify-content: center; 
  gap: 8px; 
  font-size: 0.8em; 
  color: var(--text-secondary); 
}
.status-dot-footer { width: 8px; height: 8px; border-radius: 50%; }
.status-dot-footer.online { background-color: var(--accent-green); box-shadow: 0 0 8px var(--accent-green); }
.status-dot-footer.offline { background-color: var(--accent-red); }

/* Main Content Area */
.main-viewer {
  flex: 1;
  width: 100%;
  background-color: var(--main-color);
  display: flex;
  justify-content: center;
  align-items: center;
  position: relative;
  z-index: 1;
  overflow: hidden;
}

.no-device-placeholder { text-align: center; display: flex; flex-direction: column; align-items: center; gap: 16px; }
.no-device-placeholder h2 { color: var(--text-secondary); }
.no-device-placeholder p { max-width: 300px; color: #444; font-size: 0.9em; padding: 0 20px; }

/* Remote Layout Orchestration */
.remote-viewer-wrapper {
  width: 100%;
  height: 100%;
  position: relative;
  overflow: hidden; /* Clips the background artwork strictly */
}

.remote-scroll-viewport {
  width: 100%;
  height: 100%;
  overflow-y: auto;
  overflow-x: hidden;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: flex-start;
  padding: 40px 20px;
  box-sizing: border-box;
  position: relative;
  z-index: 10;
}

.artwork-background {
  position: absolute;
  inset: -10%; /* Expand beyond edges to ensure blur coverage */
  background-size: cover;
  background-position: center;
  filter: blur(60px) brightness(0.5) saturate(1.2);
  opacity: 0.6;
  z-index: 0;
  transition: background-image 1.2s ease-in-out;
  pointer-events: none;
}

.remote-layout-horizontal {
  display: flex;
  align-items: center;
  gap: 25px;
  z-index: 20;
}

.remote-main-column {
  display: flex;
  flex-direction: column;
  align-items: center;
}

/* Now Playing & Artwork */
.now-playing-section {
  display: flex;
  align-items: center;
  gap: 15px;
  background-color: rgba(255, 255, 255, 0.05);
  padding: 12px;
  border-radius: 20px;
  margin-bottom: 5px;
}

.artwork-container {
  width: 60px; height: 60px; flex-shrink: 0; border-radius: 8px; overflow: hidden; background-color: #222; box-shadow: 0 4px 10px rgba(0,0,0,0.3);
}
.artwork-img { width: 100%; height: 100%; object-fit: cover; }
.artwork-placeholder { width: 100%; height: 100%; display: flex; align-items: center; justify-content: center; }

.metadata-container { flex: 1; overflow: hidden; display: flex; flex-direction: column; gap: 2px; }
.scrolling-text-container { width: 100%; overflow: hidden; white-space: nowrap; }
.scrolling-text-content { display: inline-block; padding-right: 40px; }
.scrolling-text-content.animate { animation: marquee var(--duration) linear infinite; animation-delay: 2s; }

@keyframes marquee {
  0% { transform: translateX(0); }
  10% { transform: translateX(0); }
  85% { transform: translateX(var(--scroll-x)); }
  100% { transform: translateX(var(--scroll-x)); }
}

.track-title { font-size: 0.95em; font-weight: 600; color: white; }
.track-artist { font-size: 0.8em; color: var(--text-secondary); }

/* Favorite Sidebar (Remote Integrated) */
.remote-favorites-sidebar {
  width: 70px;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 12px;
  padding: 15px 0;
  background-color: rgba(20, 20, 22, 0.3);
  backdrop-filter: blur(10px);
  border-radius: 35px;
  border: 1px solid rgba(255, 255, 255, 0.05);
  transition: background-color 0.3s, border-color 0.3s;
}

.remote-favorites-sidebar:hover {
  background-color: rgba(20, 20, 22, 0.5);
  border-color: rgba(255, 255, 255, 0.1);
}

.fav-sidebar-list {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 12px;
  width: 100%;
}

.fav-sidebar-item {
  background: none;
  border: none;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 4px;
  cursor: pointer;
  width: 100%;
  padding: 0 5px;
  opacity: 0.6;
  transition: opacity 0.2s, transform 0.1s;
}

.fav-sidebar-item:hover {
  opacity: 1;
  transform: scale(1.05);
}

.fav-app-icon {
  width: 52px;
  height: 32px;
  background-color: #1c1c1e;
  border-radius: 8px;
  display: flex;
  align-items: center;
  justify-content: center;
  color: #8e8e93;
  font-weight: 700;
  font-size: 1.1em;
  border: 1px solid rgba(255,255,255,0.1);
  overflow: hidden;
  box-shadow: 0 4px 10px rgba(0,0,0,0.3);
}

.icon-img {
  width: 100%;
  height: 100%;
  object-fit: cover;
  border-radius: inherit;
  filter: brightness(0.6) saturate(1.2);
  transition: filter 0.2s;
}

.fav-sidebar-item:hover .icon-img {
  filter: brightness(0.9) saturate(1.2);
}

.fav-sidebar-item.more .fav-app-icon {
  color: var(--accent-blue);
  background-color: rgba(0, 122, 255, 0.05);
  border-color: rgba(0, 122, 255, 0.2);
}

.fav-app-name {
  font-size: 0.5em;
  color: var(--text-secondary);
  text-align: center;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  width: 55px;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

/* App Drawer Overlay & Panel */
.app-drawer-overlay {
  position: absolute; inset: 0; background-color: rgba(0,0,0,0.6); backdrop-filter: blur(10px); z-index: 200; opacity: 0; pointer-events: none; transition: opacity 0.3s ease; display: flex; justify-content: flex-end;
}
.app-drawer-overlay.open { opacity: 1; pointer-events: auto; }
.app-drawer {
  width: 360px; height: 100%; background-color: #1c1c1e; box-shadow: -5px 0 30px rgba(0,0,0,0.5); display: flex; flex-direction: column; transform: translateX(100%); transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}
.app-drawer-overlay.open .app-drawer { transform: translateX(0); }
@media (max-width: 768px) { .app-drawer { width: 100%; } }

.drawer-header { padding: 20px; display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid #333; }
.header-title { display: flex; align-items: center; gap: 12px; }
.header-title h2 { margin: 0; font-size: 1.2em; font-weight: 600; }

.drawer-header-actions {
  display: flex;
  align-items: center;
  gap: 10px;
}

.empty-notice {
  display: flex;
  flex-direction: column; gap: 8px;
}

.empty-notice .hint { font-size: 0.85em; opacity: 0.6; }

.drawer-search { padding: 15px 20px; }
.search-input-wrapper { position: relative; display: flex; align-items: center; }
.search-icon { position: absolute; left: 12px; color: var(--text-secondary); }
.drawer-search input { width: 100%; padding: 10px 10px 10px 40px; background-color: #2c2c2e; border: none; border-radius: 10px; color: white; font-size: 0.95em; }

.drawer-content { flex: 1; overflow-y: auto; padding: 0 20px 20px 20px; }
.drawer-section { margin-bottom: 30px; }
.drawer-section h3 { font-size: 0.75em; text-transform: uppercase; color: var(--text-secondary); letter-spacing: 1px; margin-bottom: 15px; }

.app-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(80px, 1fr)); gap: 15px; }
.app-item.favorite { display: flex; flex-direction: column; align-items: center; gap: 8px; cursor: pointer; position: relative; }

.app-icon-mini { 
  width: 70px; height: 42px; background-color: #2c2c2e; border-radius: 10px; display: flex; align-items: center; justify-content: center; font-size: 1.4em; font-weight: 700; color: #444; border: 1px solid rgba(255,255,255,0.05); overflow: hidden;
}

.app-item .app-name { font-size: 0.75em; text-align: center; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; width: 100%; }

.fav-btn { background: none; border: none; color: var(--text-secondary); cursor: pointer; padding: 5px; transition: color 0.2s; }
.fav-btn.active { color: var(--accent-blue); }
.app-item.favorite .fav-btn { position: absolute; top: -5px; right: -5px; background-color: #1c1c1e; border-radius: 50%; box-shadow: 0 2px 5px rgba(0,0,0,0.5); }

.app-list-vertical { display: flex; flex-direction: column; gap: 10px; }
.app-list-item { display: flex; align-items: center; gap: 15px; padding: 10px; background-color: rgba(255,255,255,0.03); border-radius: 12px; cursor: pointer; transition: background-color 0.2s; }
.app-list-item:hover { background-color: rgba(255,255,255,0.08); }

.app-icon-rect { 
  width: 60px; height: 36px; background-color: #333; border-radius: 8px; display: flex; align-items: center; justify-content: center; font-weight: 700; color: #555; overflow: hidden;
}

.app-info-main { flex: 1; display: flex; flex-direction: column; gap: 2px; }
.app-name-large { font-size: 0.95em; font-weight: 500; }
.app-id-small { font-size: 0.7em; color: var(--text-secondary); }
.app-item-actions { display: flex; align-items: center; gap: 10px; }
.launch-indicator { color: var(--text-secondary); opacity: 0; transition: opacity 0.2s; }
.app-list-item:hover .launch-indicator { opacity: 1; }
.drawer-empty { text-align: center; padding: 40px 0; color: var(--text-secondary); }

/* Remote Header & Top Bar */
.remote-top-bar {
  width: 100%; max-width: 340px; display: grid; grid-template-columns: 60px 1fr 60px; align-items: center; margin-bottom: 20px; z-index: 30;
}

.mobile-menu-btn {
  background: none; border: none; color: white; cursor: pointer; padding: 8px; display: none; align-items: center; justify-content: flex-start;
}

.remote-active-name { font-weight: 600; font-size: 1.1em; color: var(--text-secondary); text-align: center; }
.remote-top-bar > *:last-child { justify-self: end; display: flex; justify-content: flex-end; }

.remote-header-actions { display: flex; align-items: center; gap: 15px; }

.icon-btn-minimal {
  background: none; border: none; color: var(--text-secondary); cursor: pointer; padding: 4px; display: flex; align-items: center; justify-content: center; transition: color 0.2s;
}
.icon-btn-minimal:hover { color: white; }

.close-remote-btn {
  background: none; border: none; color: var(--text-secondary); display: flex; align-items: center; gap: 6px; cursor: pointer; font-size: 0.9em; padding: 8px 0; justify-content: flex-start;
}

.pwr-btn { background: none; border: none; color: var(--accent-red); opacity: 0.7; cursor: pointer; transition: opacity 0.2s; padding: 8px; }
.pwr-btn:hover { opacity: 1; }

/* The Compact iOS Remote */
.compact-ios-remote {
  background-color: #111; border-radius: 50px; padding: 30px 20px; width: 300px; max-width: 100%; display: flex; flex-direction: column; gap: 20px; border: 1px solid #222; box-shadow: 0 20px 50px rgba(0,0,0,0.8); z-index: 30;
}

@media (max-height: 700px) {
  .compact-ios-remote { gap: 15px; padding: 20px 15px; }
  .touchpad-area-modern { width: 220px; height: 220px; }
  .btn-round { width: 60px; height: 60px; }
  .vol-pill { height: 120px; }
}

.touchpad-area-modern {
  width: 260px; height: 260px; background-color: #2c2c2e; border-radius: 50%; margin: 0 auto; padding: 8px; box-shadow: inset 0 2px 10px rgba(0,0,0,0.5);
}

.touchpad-grid {
  width: 100%; height: 100%; display: grid; grid-template-areas: ". up ." "left center right" ". down ."; grid-template-columns: 1fr 1fr 1fr; grid-template-rows: 1fr 1fr 1fr;
}

.nav-tap { background: none; border: none; color: #8e8e93; cursor: pointer; display: flex; align-items: center; justify-content: center; transition: color 0.2s; }
.nav-tap:hover { color: white; }
.nav-tap.up { grid-area: up; } .nav-tap.down { grid-area: down; } .nav-tap.left { grid-area: left; } .nav-tap.right { grid-area: right; }
.nav-tap.center { grid-area: center; background-color: #3a3a3c; border-radius: 50%; margin: 10px; box-shadow: 0 4px 12px rgba(0,0,0,0.4); color: white; }
.nav-tap.center:active { transform: scale(0.95); }

.remote-lower-grid { display: flex; justify-content: space-between; }
.remote-col { display: column; gap: 20px; width: 80px; align-items: center; }

.btn-round {
  width: 70px; height: 70px; border-radius: 50%; border: none; color: white; cursor: pointer; display: flex; align-items: center; justify-content: center; transition: background-color 0.2s;
}
.btn-round.glass { background-color: #2c2c2e; }
.btn-round:hover { background-color: #3a3a3c; }
.btn-round:active { transform: scale(0.92); }

.label-text { font-size: 0.7em; font-weight: 700; letter-spacing: 0.5px; }
.icons-stack { display: flex; gap: 2px; }

.vol-pill { width: 70px; height: 140px; background-color: #2c2c2e; border-radius: 35px; display: flex; flex-direction: column; overflow: hidden; }
.vol-half { flex: 1; background: none; border: none; color: white; cursor: pointer; transition: background-color 0.2s; }
.vol-half:first-child { border-bottom: 1px solid #3a3a3c; }
.vol-half:hover { background-color: #3a3a3c; }

.pair-link { background: none; border: none; color: var(--accent-blue); font-size: 0.8em; padding: 0; text-align: left; cursor: pointer; }

/* Pairing Feedback */
.pairing-loading { display: flex; flex-direction: column; align-items: center; gap: 12px; padding: 10px 0; color: var(--text-secondary); }
.pairing-loading p { font-size: 0.85em; margin: 0; }
.pairing-error-text { color: var(--accent-red); font-size: 0.8em; margin: 0; text-align: center; line-height: 1.4; }

.sidebar-pairing-form { display: flex; flex-direction: column; gap: 10px; margin-top: 8px; padding: 10px; background-color: rgba(255, 255, 255, 0.03); border-radius: 8px; }
.sidebar-pairing-form input { width: 100%; background: #2c2c2e; border: 1px solid #3a3a3c; color: white; border-radius: 6px; text-align: center; font-size: 1.1em; padding: 8px; font-weight: 600; letter-spacing: 4px; box-sizing: border-box; }
.sidebar-pairing-form input:focus { outline: none; border-color: var(--accent-blue); }
.pairing-btns { display: flex; gap: 8px; }
.pairing-btns button { flex: 1; border: none; color: white; border-radius: 6px; font-size: 0.85em; font-weight: 600; padding: 6px 0; cursor: pointer; transition: opacity 0.2s; }
.pairing-btns .ok-btn { background-color: var(--accent-green); }
.pairing-btns .cancel-btn { background-color: #3a3a3c; color: var(--text-secondary); }
.pairing-btns button:hover { opacity: 0.8; }

/* Mobile Adaptations */
@media (max-width: 768px) {
  .sidebar { position: absolute; left: 0; top: 0; bottom: 0; width: 100%; transform: translateX(-100%); }
  .sidebar-open .sidebar { transform: translateX(0); }
  .sidebar-overlay { position: absolute; inset: 0; background-color: rgba(0,0,0,0.7); z-index: 90; backdrop-filter: blur(4px); }
  .main-viewer { width: 100%; }
  .mobile-menu-btn { display: flex; }
  .remote-top-bar { max-width: 100%; }
  .remote-layout-horizontal { gap: 10px; }
  .remote-favorites-sidebar { display: none; } /* Hide on mobile to save space */
}

/* Animations */
.spin { animation: spin 2s linear infinite; }
@keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }